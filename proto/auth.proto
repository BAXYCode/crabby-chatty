syntax = "proto3";
package authentication;

service Authenticate {
  rpc Register(RegisterRequest) returns (RegisterResponse);
  rpc Login(LoginRequest) returns (LoginResponse);
  rpc Refresh(RefreshRequest) returns (RefreshResponse);
  rpc PublicKey(PublicKeyRequest) returns (PublicKeyResponse);
}

message RegisterRequest {
  string email = 1;
  string username = 2;
  string password = 3;
}
message RegisterSuccess{
  string bearer = 1;
  string refresh = 2;
  string username =3;
  string user_id =4;
}
message RegisterResponse {

    RegisterSuccess response = 1;
}

message LoginRequest {
  string username = 1;
  string password = 2;
}
message LoginSuccess {
  string refresh = 1;
  string username=2;
  string user_id =3;
}
message LoginResponse {
    LoginSuccess login_success = 1;
}

message RefreshRequest{
  string refresh = 1;
  string user_id = 2;
}
message RefreshSuccess{
  string bearer =1;
  optional string refresh =2;
}
message RefreshResponse{
  string refresh = 1;
  optional string bearer = 2;
}

message PublicKeyRequest{
string req =1;  
}
message PublicKeyResponse{
string paserk = 1;
}
